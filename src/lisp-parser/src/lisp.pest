lisp = _{SOI ~ "\n"* ~ (stmt ~ "\n"+)* ~ stmt? ~ EOI}

stmt = _{expr}

expr =  {
    assgmtExpr
  | monadicExpr
}

monadicExpr =  {operator ~ (monadicExpr | terms)}


assgmtExpr =  {ident ~ ":=" ~ (terms)}

terms =  {term+}

term = _{decimal|integer|ident|string|"(" ~ (monadicExpr | terms) ~ ")"}

operator =  {
    ">"
  | ">="
  | "*"
  | "-"
  | "/"
  | "+"
  | "*"
  | "<"
  | "<="
  | "=="
  | "!="
  | "^"
  | "|"
  | "&"
}

integer = @{"_"? ~ ASCII_DIGIT+}

decimal = @{"_"? ~ ASCII_DIGIT+ ~ "." ~ ASCII_DIGIT*}

ident = @{ASCII_ALPHA ~ (ASCII_ALPHANUMERIC|"_")*}

string = @{"'" ~ ("''"|(!"'" ~ ANY))* ~ "'"}

WHITESPACE = _{" "|"\t"}

